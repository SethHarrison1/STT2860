<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Regression models: fitting them and evaluating their performance | Machine Learning Toolbox</title>
  <meta name="description" content="The output format used for these personal notes is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Regression models: fitting them and evaluating their performance | Machine Learning Toolbox" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The output format used for these personal notes is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Regression models: fitting them and evaluating their performance | Machine Learning Toolbox" />
  
  <meta name="twitter:description" content="The output format used for these personal notes is bookdown::gitbook." />
  

<meta name="author" content="Your Name Here" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="classification-models-fitting-them-and-evaluating-their-performance.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Change this to your Title</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html"><i class="fa fa-check"></i><b>2</b> Regression models: fitting them and evaluating their performance</a><ul>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#welcome-to-the-toolbox-video"><i class="fa fa-check"></i>Welcome to the Toolbox Video</a></li>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#in-sample-rmse-for-linear-regression"><i class="fa fa-check"></i>In-sample RMSE for linear regression</a></li>
<li class="chapter" data-level="2.1" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#in-sample-rmse-for-linear-regression-on-diamonds"><i class="fa fa-check"></i><b>2.1</b> In-sample RMSE for linear regression on <code>diamonds</code></a><ul>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#exercise"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#out-of-sample-error-measures-video"><i class="fa fa-check"></i>Out-of-sample error measures video</a></li>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#out-of-sample-rmse-for-linear-regression"><i class="fa fa-check"></i>Out-of-sample RMSE for linear regression</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#randomly-order-the-data-frame"><i class="fa fa-check"></i><b>2.2</b> Randomly order the data frame</a><ul>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#exercise-1"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#try-an-8020-split"><i class="fa fa-check"></i><b>2.3</b> Try an 80/20 split</a><ul>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#exercise-2"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#predict-on-test-set"><i class="fa fa-check"></i><b>2.4</b> Predict on test set</a><ul>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#exercise-3"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#calculate-test-set-rmse"><i class="fa fa-check"></i><b>2.5</b> Calculate test set RMSE</a><ul>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#exercise-4"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#comparing-out-of-sample-rmse-to-in-sample-rmse"><i class="fa fa-check"></i>Comparing out-of-sample RMSE to in-sample RMSE</a></li>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cross-valdiation-video"><i class="fa fa-check"></i>Cross Valdiation Video</a></li>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#advantage-of-cross-validation"><i class="fa fa-check"></i>Advantage of cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#fold-cross-validation"><i class="fa fa-check"></i><b>2.6</b> 10-fold cross-validation</a><ul>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#exercise-5"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#fold-cross-validation-1"><i class="fa fa-check"></i><b>2.7</b> 5-fold cross-validation</a><ul>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#exercise-6"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#times-5-fold-cross-validation"><i class="fa fa-check"></i><b>2.8</b> <span class="math inline">\(5 \times 5\)</span>-fold cross-validation</a><ul>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#exercise-7"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#making-predictions-on-new-data"><i class="fa fa-check"></i><b>2.9</b> Making predictions on new data</a><ul>
<li class="chapter" data-level="" data-path="regression-models-fitting-them-and-evaluating-their-performance.html"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#exercise-8"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html"><i class="fa fa-check"></i><b>3</b> Classification models: fitting them and evaluating their performance</a><ul>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#logistic-regression-on-sonar-video"><i class="fa fa-check"></i>Logistic regression on sonar video</a></li>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#why-a-traintest-split"><i class="fa fa-check"></i>Why a train/test split?</a></li>
<li class="chapter" data-level="3.1" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#try-a-6040-split"><i class="fa fa-check"></i><b>3.1</b> Try a 60/40 split</a><ul>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#exercise-9"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#fit-a-logistic-regression-model"><i class="fa fa-check"></i><b>3.2</b> Fit a logistic regression model</a><ul>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#exercise-10"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#confusion-matrix-video"><i class="fa fa-check"></i>Confusion matrix video</a></li>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#confusion-matrix"><i class="fa fa-check"></i>Confusion Matrix</a></li>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#confusion-matrix-takeaways"><i class="fa fa-check"></i>Confusion matrix takeaways</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#calculate-a-confusion-matrix"><i class="fa fa-check"></i><b>3.3</b> Calculate a confusion matrix</a><ul>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#exercise-11"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#exercise-12"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#class-probabilities-and-predictions-video"><i class="fa fa-check"></i>Class probabilities and predictions video</a></li>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#exercise-13"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#try-another-threshold"><i class="fa fa-check"></i><b>3.4</b> Try another threshold</a></li>
<li class="chapter" data-level="3.5" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#from-probabilites-to-confusion-matrix"><i class="fa fa-check"></i><b>3.5</b> From probabilites to confusion matrix</a><ul>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#introducing-the-roc-curve-video"><i class="fa fa-check"></i>Introducing the ROC curve video</a></li>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#whats-the-value-of-a-roc-curve"><i class="fa fa-check"></i>What’s the value of a ROC curve?</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#plot-an-roc-curve"><i class="fa fa-check"></i><b>3.6</b> Plot an ROC curve</a><ul>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#exercise-14"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#area-under-the-curve-auc-video"><i class="fa fa-check"></i>Area under the curve (AUC) video</a></li>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#model-roc-and-auc"><i class="fa fa-check"></i>Model, ROC, and AUC</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#customizing-traincontrol"><i class="fa fa-check"></i><b>3.7</b> Customizing <code>trainControl</code></a><ul>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#exercise-15"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#using-custom-traincontrol"><i class="fa fa-check"></i><b>3.8</b> Using custom <code>trainControl</code></a><ul>
<li class="chapter" data-level="" data-path="classification-models-fitting-them-and-evaluating-their-performance.html"><a href="classification-models-fitting-them-and-evaluating-their-performance.html#exercise-16"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html"><i class="fa fa-check"></i><b>4</b> Tuning model parameters to improve performance</a><ul>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#random-forests-and-wine-video"><i class="fa fa-check"></i>Random forests and wine video</a></li>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#random-forests-vs.-linear-models"><i class="fa fa-check"></i>Random forests vs. linear models</a></li>
<li class="chapter" data-level="4.1" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#fit-a-random-forest"><i class="fa fa-check"></i><b>4.1</b> Fit a random forest</a><ul>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#exercise-17"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#explore-a-wider-model-space-video"><i class="fa fa-check"></i>Explore a wider model space video</a></li>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#advantage-of-a-longer-tune-length"><i class="fa fa-check"></i>Advantage of a longer tune length</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#try-a-longer-tune-length"><i class="fa fa-check"></i><b>4.2</b> Try a longer tune length</a><ul>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#exercise-18"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#custom-tuning-grids-video"><i class="fa fa-check"></i>Custom tuning grids video</a></li>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#advantages-of-a-custom-tuning-grid"><i class="fa fa-check"></i>Advantages of a custom tuning grid</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#fit-a-random-forest-with-custom-tuning"><i class="fa fa-check"></i><b>4.3</b> Fit a random forest with custom tuning</a><ul>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#exercise-19"><i class="fa fa-check"></i>Exercise</a></li>
<li><a href="tuning-model-parameters-to-improve-performance.html#introducing-glmnet-video">Introducing <code>glmnet</code> video</a></li>
<li><a href="tuning-model-parameters-to-improve-performance.html#advantage-of-glmnet">Advantage of <code>glmnet</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#make-a-custom-traincontrol"><i class="fa fa-check"></i><b>4.4</b> Make a custom <code>trainControl</code></a><ul>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#exercise-20"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#fit-glmnet-with-custom-traincontrol"><i class="fa fa-check"></i><b>4.5</b> Fit glmnet with custom <code>trainControl</code></a><ul>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#exercise-21"><i class="fa fa-check"></i>Exercise</a></li>
<li><a href="tuning-model-parameters-to-improve-performance.html#glmnet-with-custom-tuning-grid-video"><code>glmnet</code> with custom tuning grid video</a></li>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#why-a-custom-tuning-grid"><i class="fa fa-check"></i>Why a custom tuning grid?</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#glmnet-with-custom-traincontrol-and-tuning"><i class="fa fa-check"></i><b>4.6</b> <code>glmnet</code> with custom <code>trainControl</code> and tuning</a><ul>
<li class="chapter" data-level="" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#exercise-22"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="tuning-model-parameters-to-improve-performance.html"><a href="tuning-model-parameters-to-improve-performance.html#interpreting-glmnet-plots"><i class="fa fa-check"></i><b>4.7</b> Interpreting <code>glmnet</code> plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html"><i class="fa fa-check"></i><b>5</b> Preprocessing your data</a><ul>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#median-imputation-video"><i class="fa fa-check"></i>Median imputation video</a></li>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#median-imputation-vs.-omitting-rows"><i class="fa fa-check"></i>Median imputation vs. omitting rows</a></li>
<li class="chapter" data-level="5.1" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#apply-median-imputation"><i class="fa fa-check"></i><b>5.1</b> Apply median imputation</a><ul>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#exercise-23"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#use-knn-imputation-video"><i class="fa fa-check"></i>Use KNN imputation video</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#use-knn-imputation"><i class="fa fa-check"></i><b>5.2</b> Use KNN imputation</a><ul>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#exercise-24"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#compare-knn-and-median-imputation"><i class="fa fa-check"></i>Compare KNN and median imputation</a></li>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#order-of-operations"><i class="fa fa-check"></i>Order of operations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#combining-preprocessing-methods"><i class="fa fa-check"></i><b>5.3</b> 5.3 Combining preprocessing methods</a><ul>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#exercise-25"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#handling-low-information-predictors-video"><i class="fa fa-check"></i>Handling low-information predictors video</a></li>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#why-remove-near-zero-variance-predictors"><i class="fa fa-check"></i>Why remove near zero variance predictors?</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#remove-near-zero-variance-predictors"><i class="fa fa-check"></i><b>5.4</b> Remove near zero variance predictors</a><ul>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#exercise-26"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="5.4.1" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#preprocess-and-nearzerovar"><i class="fa fa-check"></i><b>5.4.1</b> <code>preProcess()</code> and <code>nearZeroVar()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#fit-model-on-reduced-blood-brain-data"><i class="fa fa-check"></i><b>5.5</b> Fit model on reduced blood-brain data</a><ul>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#exercise-27"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#principle-components-analysis-pca-video"><i class="fa fa-check"></i>Principle components analysis (PCA) video</a></li>
<li class="chapter" data-level="" data-path="preprocessing-your-data.html"><a href="preprocessing-your-data.html#exercise-28"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html"><i class="fa fa-check"></i><b>6</b> Selecting models: a case study in churn prediction</a><ul>
<li><a href="selecting-models-a-case-study-in-churn-prediction.html#reusing-a-traincontrol-video">Reusing a <code>trainControl</code> video</a></li>
<li><a href="selecting-models-a-case-study-in-churn-prediction.html#why-reuse-a-traincontrol">Why reuse a <code>trainControl</code>?</a></li>
<li class="chapter" data-level="6.1" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#make-custom-traintest-indices"><i class="fa fa-check"></i><b>6.1</b> Make custom train/test indices</a><ul>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#exercise-29"><i class="fa fa-check"></i>Exercise</a></li>
<li><a href="selecting-models-a-case-study-in-churn-prediction.html#reintroducing-glmnet-video">Reintroducing <code>glmnet</code> video</a></li>
<li><a href="selecting-models-a-case-study-in-churn-prediction.html#glmnet-as-a-baseline-model"><code>glmnet</code> as a baseline model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#fit-the-baseline-model"><i class="fa fa-check"></i><b>6.2</b> Fit the baseline model</a><ul>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#exercise-30"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#reintroducing-random-forest-video"><i class="fa fa-check"></i>Reintroducing random forest video</a></li>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#random-forest-drawback"><i class="fa fa-check"></i>Random Forest Drawback</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#random-forest-with-custom-traincontrol"><i class="fa fa-check"></i><b>6.3</b> Random forest with custom trainControl</a><ul>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#exercise-31"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#comparing-models-video"><i class="fa fa-check"></i>Comparing models video</a></li>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#matching-traintest-indices"><i class="fa fa-check"></i>Matching train/test indices</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#create-a-resamples-object"><i class="fa fa-check"></i><b>6.4</b> Create a resamples object</a><ul>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#exercise-32"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#more-on-resamples-video"><i class="fa fa-check"></i>More on resamples video</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#create-a-box-and-whisker-plot"><i class="fa fa-check"></i><b>6.5</b> Create a box-and-whisker plot</a><ul>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#exercise-33"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#create-a-scatterplot"><i class="fa fa-check"></i><b>6.6</b> Create a scatterplot</a><ul>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#exercise-34"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#ensembling-models"><i class="fa fa-check"></i><b>6.7</b> Ensembling models</a><ul>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#exercise-35"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="selecting-models-a-case-study-in-churn-prediction.html"><a href="selecting-models-a-case-study-in-churn-prediction.html#summary-video"><i class="fa fa-check"></i>Summary video</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><a href="https://www.datacamp.com/courses/machine-learning-toolbox">Machine Learning Toolbox</a></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression-models-fitting-them-and-evaluating-their-performance" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Regression models: fitting them and evaluating their performance</h1>
<p>In the first chapter of this course, you’ll fit regression models with <code>train()</code> and evaluate their out-of-sample performance using cross-validation and root-mean-square error (RMSE).</p>
<hr />
<div id="welcome-to-the-toolbox-video" class="section level3 unnumbered">
<h3>Welcome to the Toolbox Video</h3>
<iframe src="https://drive.google.com/file/d/1HWTPEixyJOFYntkTX2az-KS_g-04uI7p/preview" width="740" height="420">
</iframe>
<hr />
</div>
<div id="in-sample-rmse-for-linear-regression" class="section level3 unnumbered">
<h3>In-sample RMSE for linear regression</h3>
<p>RMSE is commonly calculated in-sample on your training set. What’s a potential drawback to calculating training set error?</p>
<ul>
<li><p>There’s no potential drawback to calculating training set error, but you should calculate <span class="math inline">\(R^2\)</span> instead of RMSE.</p></li>
<li><p><strong>You have no idea how well your model generalizes to new data (i.e. overfitting).</strong></p></li>
<li><p>You should manually inspect your model to validate its coefficients and calculate RMSE.</p></li>
</ul>
<hr />
</div>
<div id="in-sample-rmse-for-linear-regression-on-diamonds" class="section level2">
<h2><span class="header-section-number">2.1</span> In-sample RMSE for linear regression on <code>diamonds</code></h2>
<p><code>diamonds</code> is a classic dataset from the <code>ggplot2</code> package written by <span class="citation">Wickham et al. (<a href="#ref-R-ggplot2" role="doc-biblioref">2020</a>)</span>. The dataset contains physical attributes of diamonds as well as the price they sold for. One interesting modeling challenge is predicting diamond price based on their attributes using something like a linear regression.</p>
<p>Recall that to fit a linear regression, you use the <code>lm()</code> function in the following format:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb1-1"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> my_data)</span></code></pre></div>
<p>To make predictions using <code>mod</code> on the original data, you call the <code>predict()</code> function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb2-1"></a>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, <span class="dt">newdata =</span> my_data)</span></code></pre></div>
<hr />
<div id="exercise" class="section level3 unnumbered">
<h3>Exercise</h3>
<ul>
<li>Fit a linear model on the diamonds dataset predicting price using all other variables as predictors (i.e. <code>price ~ .</code>). Save the result to <code>model</code>.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb3-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb3-2"></a><span class="co"># Fit lm model: model</span></span>
<span id="cb3-3"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb3-3"></a>model &lt;-<span class="st"> </span><span class="kw">lm</span>(price <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> diamonds)</span></code></pre></div>
<ul>
<li>Make predictions using <code>model</code> on the full original dataset and save the result to <code>p</code>.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb4-1"></a><span class="co"># Predict on full data: p</span></span>
<span id="cb4-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb4-2"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(model, <span class="dt">newdata =</span> diamonds)</span></code></pre></div>
<ul>
<li>Compute errors using the formula <code>errors = actual - predicted</code>. Save the result to <code>error</code>.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb5-1"></a><span class="co"># Compute errors: error</span></span>
<span id="cb5-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb5-2"></a>error &lt;-<span class="st"> </span>diamonds<span class="op">$</span>price <span class="op">-</span><span class="st"> </span>p</span></code></pre></div>
<ul>
<li>Compute RMSE and print it to the console.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb6-1"></a><span class="co"># Compute RMSE</span></span>
<span id="cb6-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb6-2"></a>RMSE &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(error<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb6-3"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb6-3"></a>RMSE</span></code></pre></div>
<pre><code>[1] 1129.843</code></pre>
<hr />
</div>
<div id="out-of-sample-error-measures-video" class="section level3 unnumbered">
<h3>Out-of-sample error measures video</h3>
<iframe src="https://drive.google.com/file/d/1yH_l3-YqXb2H5wGg5vYmdRXUYcH0XkzS/preview" width="740" height="420">
</iframe>
<hr />
</div>
<div id="out-of-sample-rmse-for-linear-regression" class="section level3 unnumbered">
<h3>Out-of-sample RMSE for linear regression</h3>
<p>What is the advantage of using a train/test split rather than just validating your model in-sample on the training set?</p>
<ul>
<li><p>It takes less time to calculate error on the test set, since it is smaller than the training set.</p></li>
<li><p>There is no advantage to using a test set. You can just use adjusted <span class="math inline">\(R^2\)</span> on your training set.</p></li>
<li><p><strong>It gives you an estimate of how well your model performs on new data.</strong></p></li>
</ul>
<hr />
</div>
</div>
<div id="randomly-order-the-data-frame" class="section level2">
<h2><span class="header-section-number">2.2</span> Randomly order the data frame</h2>
<p>One way you can take a train/test split of a dataset is to order the dataset randomly, then divide it into the two sets. This ensures that the training set and test set are both random samples and that any biases in the ordering of the dataset (e.g. if it had originally been ordered by <code>price</code> or <code>size</code>) are not retained in the samples we take for training and testing your models. You can think of this like shuffling a brand new deck of playing cards before dealing hands.</p>
<p>First, you set a random seed so that your work is reproducible and you get the same random split each time you run your script:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb8-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
<p>Next, you use the <code>sample()</code> function to shuffle the row indices of the <code>diamonds</code> dataset. You can later use these these indices to reorder the dataset.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb9-1"></a>rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(diamonds))</span></code></pre></div>
<p>Finally, you can use this random vector to reorder the diamonds dataset:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb10-1"></a>diamonds &lt;-<span class="st"> </span>diamonds[rows, ]</span></code></pre></div>
<hr />
<div id="exercise-1" class="section level3 unnumbered">
<h3>Exercise</h3>
<ul>
<li>Set the random seed to 42.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb11-1"></a><span class="co"># Set seed</span></span>
<span id="cb11-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb11-2"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
<ul>
<li>Make a vector of row indices called <code>rows</code>.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb12-1"></a><span class="co"># Shuffle row indices: rows</span></span>
<span id="cb12-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb12-2"></a>rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(diamonds))</span></code></pre></div>
<ul>
<li>Randomly reorder the <code>diamonds</code> data frame.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb13-1"></a><span class="co"># Randomly order data</span></span>
<span id="cb13-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb13-2"></a>diamonds &lt;-<span class="st"> </span>diamonds[rows, ]</span></code></pre></div>
<hr />
</div>
</div>
<div id="try-an-8020-split" class="section level2">
<h2><span class="header-section-number">2.3</span> Try an 80/20 split</h2>
<p>Now that your dataset is randomly ordered, you can split the first 80% of it into a training set, and the last 20% into a test set. You can do this by choosing a split point approximately 80% of the way through your data:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb14-1"></a>split &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">nrow</span>(mydata) <span class="op">*</span><span class="st"> </span><span class="fl">0.80</span>)</span></code></pre></div>
<p>You can then use this point to break off the first 80% of the dataset as a training set:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb15-1"></a>mydata[<span class="dv">1</span><span class="op">:</span>split, ]</span></code></pre></div>
<p>And then you can use that same point to determine the test set:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb16-1"></a>mydata[(split <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span><span class="kw">nrow</span>(mydata), ]</span></code></pre></div>
<hr />
<div id="exercise-2" class="section level3 unnumbered">
<h3>Exercise</h3>
<ul>
<li>Choose a row index to split on so that the split point is approximately 80% of the way through the <code>diamonds</code> dataset. Call this index <code>split</code>.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb17-1"></a><span class="co"># Determine row to split on: split</span></span>
<span id="cb17-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb17-2"></a>split &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">nrow</span>(diamonds)<span class="op">*</span><span class="fl">0.80</span>)</span></code></pre></div>
<ul>
<li>Create a training set called <code>train</code> using that index.</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb18-1"></a><span class="co"># Create train</span></span>
<span id="cb18-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb18-2"></a>train &lt;-<span class="st"> </span>diamonds[<span class="dv">1</span><span class="op">:</span>split, ]</span></code></pre></div>
<ul>
<li>Create a test set called <code>test</code> using that index.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb19-1"></a><span class="co"># Create test</span></span>
<span id="cb19-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb19-2"></a>test &lt;-<span class="st"> </span>diamonds[(split <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span><span class="kw">nrow</span>(diamonds), ]</span></code></pre></div>
<hr />
</div>
</div>
<div id="predict-on-test-set" class="section level2">
<h2><span class="header-section-number">2.4</span> Predict on test set</h2>
<p>Now that you have a randomly split training set and test set, you can use the <code>lm()</code> function as you did in the first exercise to fit a model to your training set, rather than the entire dataset. Recall that you can use the formula interface to the linear regression function to fit a model with a specified target variable using all other variables in the dataset as predictors:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb20-1"></a>mod &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> training_data)</span></code></pre></div>
<p>You can use the <code>predict()</code> function to make predictions from that model on new data. The new dataset must have all of the columns from the training data, but they can be in a different order with different values. Here, rather than re-predicting on the training set, you can predict on the test set, which you did not use for training the model. This will allow you to determine the <em>out-of-sample error</em> for the model in the next exercise:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb21-1"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(model, <span class="dt">newdata =</span> new_data)</span></code></pre></div>
<hr />
<div id="exercise-3" class="section level3 unnumbered">
<h3>Exercise</h3>
<ul>
<li>Fit an <code>lm()</code> model called <code>model</code> to predict price using all other variables as covariates. Be sure to use the training set, <code>train</code>.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb22-1"></a><span class="co"># Fit lm model on train: model</span></span>
<span id="cb22-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb22-2"></a>model &lt;-<span class="st"> </span><span class="kw">lm</span>(price <span class="op">~</span><span class="st"> </span>. , <span class="dt">data =</span> train)</span></code></pre></div>
<ul>
<li>Predict on the test set, test, using <code>predict()</code>. Store these values in a vector called <code>p</code>.</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb23-1"></a><span class="co"># Predict on test: p</span></span>
<span id="cb23-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb23-2"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(model, <span class="dt">newdata =</span> test, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="calculate-test-set-rmse" class="section level2">
<h2><span class="header-section-number">2.5</span> Calculate test set RMSE</h2>
<p>Now that you have predictions on the test set, you can use these predictions to calculate an error metric (in this case RMSE) on the test set and see how the model performs out-of-sample, rather than in-sample as you did in the first exercise. You first do this by calculating the errors between the predicted diamond prices and the actual diamond prices by subtracting the predictions from the actual values.</p>
<p>Once you have an error vector, calculating RMSE is as simple as squaring it, taking the mean, then taking the square root:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb24-1"></a><span class="kw">sqrt</span>(<span class="kw">mean</span>(error<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<hr />
<div id="exercise-4" class="section level3 unnumbered">
<h3>Exercise</h3>
<ul>
<li>Calculate the error between the predictions on the test set and the actual diamond prices in the test set. Call this <code>error</code>.</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb25-1"></a><span class="co"># Compute errors: error</span></span>
<span id="cb25-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb25-2"></a>error &lt;-<span class="st"> </span>test<span class="op">$</span>price <span class="op">-</span><span class="st"> </span>p</span></code></pre></div>
<ul>
<li>Calculate RMSE using this error vector, just printing the result to the console.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb26-1"></a><span class="co"># Calculate RMSE</span></span>
<span id="cb26-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb26-2"></a>RMSE &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(error<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb26-3"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb26-3"></a>RMSE</span></code></pre></div>
<pre><code>[1] 1137.466</code></pre>
<hr />
</div>
<div id="comparing-out-of-sample-rmse-to-in-sample-rmse" class="section level3 unnumbered">
<h3>Comparing out-of-sample RMSE to in-sample RMSE</h3>
<p>Why is the test set RMSE higher than the training set RMSE?</p>
<ul>
<li><p><strong>Because you overfit the training set and the test set contains data the model hasn’t seen before.</strong></p></li>
<li><p>Because you should not use a test set at all and instead just look at error on the training set.</p></li>
<li><p>Because the test set has a smaller sample size the training set and thus the mean error is lower.</p></li>
</ul>
<hr />
</div>
<div id="cross-valdiation-video" class="section level3 unnumbered">
<h3>Cross Valdiation Video</h3>
<iframe src="https://drive.google.com/file/d/1TU_Xhjm_Ldlh4yBbKX_2Et6A5cDFSp5R/preview" width="740" height="420">
</iframe>
<hr />
</div>
<div id="advantage-of-cross-validation" class="section level3 unnumbered">
<h3>Advantage of cross-validation</h3>
<p>What is the advantage of cross-validation over a single train/test split?</p>
<ul>
<li><p>There is no advantage to cross-validation, just as there is no advantage to a single train/test split. You should be validating your models in-sample with a metric like adjusted <span class="math inline">\(R^2\)</span>.</p></li>
<li><p>You can pick the best test set to minimize the reported RMSE of your model.</p></li>
<li><p><strong>It gives you multiple estimates of out-of-sample error, rather than a single estimate.</strong></p></li>
</ul>
<p>Note: If all of your estimates give similar outputs, you can be more certain of the model’s accuracy. If your estimates give different outputs, that tells you the model does not perform consistently and suggests a problem with it.</p>
</div>
</div>
<div id="fold-cross-validation" class="section level2">
<h2><span class="header-section-number">2.6</span> 10-fold cross-validation</h2>
<p>A better approach to validating models is to use multiple systematic test sets rather than a single random train/test split. Fortunately, the <code>caret</code> package written by <span class="citation">Kuhn (<a href="#ref-R-caret" role="doc-biblioref">2020</a>)</span> makes this very easy to do:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb28-1"></a>model &lt;-<span class="st"> </span><span class="kw">train</span>(y <span class="op">~</span><span class="st"> </span>., my_data)</span></code></pre></div>
<p><code>caret</code> supports many types of cross-validation, and you can specify which type of cross-validation and the number of cross-validation folds with the <code>trainControl()</code> function, which you pass to the <code>trControl</code> argument in <code>train()</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb29-1"></a>model &lt;-<span class="st"> </span><span class="kw">train</span>(</span>
<span id="cb29-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb29-2"></a>  y <span class="op">~</span><span class="st"> </span>., my_data,</span>
<span id="cb29-3"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb29-3"></a>  <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb29-4"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb29-4"></a>  <span class="dt">trControl =</span> <span class="kw">trainControl</span>(</span>
<span id="cb29-5"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb29-5"></a>    <span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dt">number =</span> <span class="dv">10</span>,</span>
<span id="cb29-6"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb29-6"></a>    <span class="dt">verboseIter =</span> <span class="ot">TRUE</span></span>
<span id="cb29-7"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb29-7"></a>  )</span>
<span id="cb29-8"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb29-8"></a>)</span></code></pre></div>
<p>It is important to note that you pass the method for modeling to the main <code>train()</code> function and the method for cross-validation to the <code>trainControl()</code> function.</p>
<hr />
<div id="exercise-5" class="section level3 unnumbered">
<h3>Exercise</h3>
<ul>
<li>Load the <code>caret</code> package.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb30-1"></a><span class="co"># Load the caret package</span></span>
<span id="cb30-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb30-2"></a><span class="kw">library</span>(caret)</span></code></pre></div>
<ul>
<li>Fit a linear regression to model price using all other variables in the <code>diamonds</code> dataset as predictors. Use the <code>train()</code> function and 10-fold cross-validation.</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb31-1"></a><span class="co"># Fit lm model using 10-fold CV: model</span></span>
<span id="cb31-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb31-2"></a>model &lt;-<span class="st"> </span><span class="kw">train</span>(</span>
<span id="cb31-3"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb31-3"></a>  price <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> diamonds,</span>
<span id="cb31-4"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb31-4"></a>  <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb31-5"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb31-5"></a>  <span class="dt">trControl =</span> <span class="kw">trainControl</span>(</span>
<span id="cb31-6"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb31-6"></a>    <span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dt">number =</span> <span class="dv">10</span>,</span>
<span id="cb31-7"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb31-7"></a>    <span class="dt">verboseIter =</span> <span class="ot">FALSE</span></span>
<span id="cb31-8"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb31-8"></a>  )</span>
<span id="cb31-9"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb31-9"></a>)</span></code></pre></div>
<ul>
<li>Print the model to the console and examine the results.</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb32-1"></a><span class="co"># Print model to console</span></span>
<span id="cb32-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb32-2"></a>model</span></code></pre></div>
<pre><code>Linear Regression 

53940 samples
    9 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 48547, 48546, 48546, 48547, 48545, 48547, ... 
Resampling results:

  RMSE      Rsquared   MAE     
  1130.633  0.9197711  740.5017

Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb34-1"></a>model<span class="op">$</span>finalModel  <span class="co"># show model coefficients </span></span></code></pre></div>
<pre><code>
Call:
lm(formula = .outcome ~ ., data = dat)

Coefficients:
(Intercept)        carat        cut.L        cut.Q        cut.C      `cut^4`  
   5753.762    11256.978      584.457     -301.908      148.035      -20.794  
    color.L      color.Q      color.C    `color^4`    `color^5`    `color^6`  
  -1952.160     -672.054     -165.283       38.195      -95.793      -48.466  
  clarity.L    clarity.Q    clarity.C  `clarity^4`  `clarity^5`  `clarity^6`  
   4097.431    -1925.004      982.205     -364.918      233.563        6.883  
`clarity^7`        depth        table            x            y            z  
     90.640      -63.806      -26.474    -1008.261        9.609      -50.119  </code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb36-1"></a><span class="co"># summary(model)  # to see all</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="fold-cross-validation-1" class="section level2">
<h2><span class="header-section-number">2.7</span> 5-fold cross-validation</h2>
<p>In this tutorial, you will use a wide variety of datasets to explore the full flexibility of the <code>caret</code> package. Here, you will use the famous <code>Boston</code> housing dataset, where the goal is to predict median home values in various Boston suburbs.</p>
<p>You can use exactly the same code as in the previous exercise, but change the dataset used by the model:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb37-1"></a>model &lt;-<span class="st"> </span><span class="kw">train</span>(</span>
<span id="cb37-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb37-2"></a>  medv <span class="op">~</span><span class="st"> </span>., Boston,</span>
<span id="cb37-3"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb37-3"></a>  <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb37-4"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb37-4"></a>  <span class="dt">trControl =</span> <span class="kw">trainControl</span>(</span>
<span id="cb37-5"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb37-5"></a>    <span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dt">number =</span> <span class="dv">10</span>,</span>
<span id="cb37-6"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb37-6"></a>    <span class="dt">verboseIter =</span> <span class="ot">FALSE</span></span>
<span id="cb37-7"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb37-7"></a>  )</span>
<span id="cb37-8"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb37-8"></a>)</span></code></pre></div>
<p>Next, you can reduce the number of cross-validation folds from 10 to 5 using the number argument to the <code>trainControl()</code> argument:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb38-1"></a>trControl =<span class="st"> </span><span class="kw">trainControl</span>(</span>
<span id="cb38-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb38-2"></a>  <span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dt">number =</span> <span class="dv">5</span>,</span>
<span id="cb38-3"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb38-3"></a>  <span class="dt">verboseIter =</span> <span class="ot">TRUE</span></span>
<span id="cb38-4"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb38-4"></a>)</span></code></pre></div>
<hr />
<div id="exercise-6" class="section level3 unnumbered">
<h3>Exercise</h3>
<ul>
<li>Load the <code>MASS</code> package.</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb39-1"></a><span class="co"># Load the MASS pacakge</span></span>
<span id="cb39-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb39-2"></a><span class="kw">library</span>(MASS)</span></code></pre></div>
<ul>
<li>Fit an <code>lm()</code> model to the <code>Boston</code> housing dataset, such that <code>medv</code> is the response variable and all other variables are explanatory variables. Use 5-fold cross-validation rather than 10-fold cross-validation.</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb40-1"></a><span class="co"># Fit lm model using 5-fold CV: model</span></span>
<span id="cb40-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb40-2"></a>model &lt;-<span class="st"> </span><span class="kw">train</span>(</span>
<span id="cb40-3"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb40-3"></a>  medv <span class="op">~</span>. , <span class="dt">data =</span> Boston,</span>
<span id="cb40-4"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb40-4"></a>  <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb40-5"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb40-5"></a>  <span class="dt">trControl =</span> <span class="kw">trainControl</span>(</span>
<span id="cb40-6"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb40-6"></a>    <span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dt">number =</span> <span class="dv">5</span>,</span>
<span id="cb40-7"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb40-7"></a>    <span class="dt">verboseIter =</span> <span class="ot">FALSE</span></span>
<span id="cb40-8"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb40-8"></a>  )</span>
<span id="cb40-9"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb40-9"></a>)</span></code></pre></div>
<ul>
<li>Print the model to the console and inspect the results.</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb41-1"></a><span class="co"># Print model to console</span></span>
<span id="cb41-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb41-2"></a>model</span></code></pre></div>
<pre><code>Linear Regression 

506 samples
 13 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 405, 405, 406, 403, 405 
Resampling results:

  RMSE      Rsquared   MAE     
  4.860247  0.7209221  3.398114

Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb43-1"></a><span class="co"># show coefficients of model</span></span>
<span id="cb43-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb43-2"></a>model<span class="op">$</span>finalModel </span></code></pre></div>
<pre><code>
Call:
lm(formula = .outcome ~ ., data = dat)

Coefficients:
(Intercept)         crim           zn        indus         chas          nox  
  3.646e+01   -1.080e-01    4.642e-02    2.056e-02    2.687e+00   -1.777e+01  
         rm          age          dis          rad          tax      ptratio  
  3.810e+00    6.922e-04   -1.476e+00    3.060e-01   -1.233e-02   -9.527e-01  
      black        lstat  
  9.312e-03   -5.248e-01  </code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb45-1"></a><span class="kw">summary</span>(model)</span></code></pre></div>
<pre><code>
Call:
lm(formula = .outcome ~ ., data = dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.595  -2.730  -0.518   1.777  26.199 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.646e+01  5.103e+00   7.144 3.28e-12 ***
crim        -1.080e-01  3.286e-02  -3.287 0.001087 ** 
zn           4.642e-02  1.373e-02   3.382 0.000778 ***
indus        2.056e-02  6.150e-02   0.334 0.738288    
chas         2.687e+00  8.616e-01   3.118 0.001925 ** 
nox         -1.777e+01  3.820e+00  -4.651 4.25e-06 ***
rm           3.810e+00  4.179e-01   9.116  &lt; 2e-16 ***
age          6.922e-04  1.321e-02   0.052 0.958229    
dis         -1.476e+00  1.995e-01  -7.398 6.01e-13 ***
rad          3.060e-01  6.635e-02   4.613 5.07e-06 ***
tax         -1.233e-02  3.760e-03  -3.280 0.001112 ** 
ptratio     -9.527e-01  1.308e-01  -7.283 1.31e-12 ***
black        9.312e-03  2.686e-03   3.467 0.000573 ***
lstat       -5.248e-01  5.072e-02 -10.347  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.745 on 492 degrees of freedom
Multiple R-squared:  0.7406,    Adjusted R-squared:  0.7338 
F-statistic: 108.1 on 13 and 492 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
</div>
</div>
<div id="times-5-fold-cross-validation" class="section level2">
<h2><span class="header-section-number">2.8</span> <span class="math inline">\(5 \times 5\)</span>-fold cross-validation</h2>
<p>You can do more than just one iteration of cross-validation. Repeated cross-validation gives you a better estimate of the test-set error. You can also repeat the entire cross-validation procedure. This takes longer, but gives you many more out-of-sample datasets to look at and much more precise assessments of how well the model performs.</p>
<p>One of the awesome things about the <code>train()</code> function in <code>caret</code> is how easy it is to run very different models or methods of cross-validation just by tweaking a few simple arguments to the function call. For example, you could repeat your entire cross-validation procedure 5 times for greater confidence in your estimates of the model’s out-of-sample accuracy, e.g.:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb47-1"></a>trControl =<span class="st"> </span><span class="kw">trainControl</span>(</span>
<span id="cb47-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb47-2"></a>  <span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="dt">number =</span> <span class="dv">5</span>,</span>
<span id="cb47-3"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb47-3"></a>  <span class="dt">repeats =</span> <span class="dv">5</span>, <span class="dt">verboseIter =</span> <span class="ot">TRUE</span></span>
<span id="cb47-4"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb47-4"></a>)</span></code></pre></div>
<hr />
<div id="exercise-7" class="section level3 unnumbered">
<h3>Exercise</h3>
<ul>
<li>Re-fit the linear regression model to the <code>Boston</code> housing dataset. Use 5 repeats of 5-fold cross-validation.</li>
</ul>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb48-1"></a><span class="co"># Fit lm model using 5 x 5-fold CV: model</span></span>
<span id="cb48-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb48-2"></a>model &lt;-<span class="st"> </span><span class="kw">train</span>(</span>
<span id="cb48-3"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb48-3"></a>  medv <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> Boston,</span>
<span id="cb48-4"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb48-4"></a>  <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb48-5"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb48-5"></a>  <span class="dt">trControl =</span> <span class="kw">trainControl</span>(</span>
<span id="cb48-6"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb48-6"></a>    <span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="dt">number =</span> <span class="dv">5</span>,</span>
<span id="cb48-7"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb48-7"></a>    <span class="dt">repeats =</span> <span class="dv">5</span>, <span class="dt">verboseIter =</span> <span class="ot">FALSE</span></span>
<span id="cb48-8"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb48-8"></a>  )</span>
<span id="cb48-9"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb48-9"></a>)</span></code></pre></div>
<ul>
<li>Print the model to the console.</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb49-1"></a><span class="co"># Print model to console</span></span>
<span id="cb49-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb49-2"></a>model</span></code></pre></div>
<pre><code>Linear Regression 

506 samples
 13 predictor

No pre-processing
Resampling: Cross-Validated (5 fold, repeated 5 times) 
Summary of sample sizes: 405, 406, 405, 403, 405, 405, ... 
Resampling results:

  RMSE      Rsquared   MAE     
  4.845724  0.7277269  3.402735

Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb51-1"></a><span class="kw">summary</span>(model)</span></code></pre></div>
<pre><code>
Call:
lm(formula = .outcome ~ ., data = dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.595  -2.730  -0.518   1.777  26.199 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.646e+01  5.103e+00   7.144 3.28e-12 ***
crim        -1.080e-01  3.286e-02  -3.287 0.001087 ** 
zn           4.642e-02  1.373e-02   3.382 0.000778 ***
indus        2.056e-02  6.150e-02   0.334 0.738288    
chas         2.687e+00  8.616e-01   3.118 0.001925 ** 
nox         -1.777e+01  3.820e+00  -4.651 4.25e-06 ***
rm           3.810e+00  4.179e-01   9.116  &lt; 2e-16 ***
age          6.922e-04  1.321e-02   0.052 0.958229    
dis         -1.476e+00  1.995e-01  -7.398 6.01e-13 ***
rad          3.060e-01  6.635e-02   4.613 5.07e-06 ***
tax         -1.233e-02  3.760e-03  -3.280 0.001112 ** 
ptratio     -9.527e-01  1.308e-01  -7.283 1.31e-12 ***
black        9.312e-03  2.686e-03   3.467 0.000573 ***
lstat       -5.248e-01  5.072e-02 -10.347  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.745 on 492 degrees of freedom
Multiple R-squared:  0.7406,    Adjusted R-squared:  0.7338 
F-statistic: 108.1 on 13 and 492 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
</div>
</div>
<div id="making-predictions-on-new-data" class="section level2">
<h2><span class="header-section-number">2.9</span> Making predictions on new data</h2>
<p>Finally, the model you fit with the <code>train()</code> function has the exact same <code>predict()</code> interface as the linear regression models you fit earlier.</p>
<p>After fitting a model with <code>train()</code>, you can call <code>predict()</code> with new data, e.g:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb53-1"></a><span class="kw">predict</span>(my_model, <span class="dt">newdata =</span> new_data)</span></code></pre></div>
<hr />
<div id="exercise-8" class="section level3 unnumbered">
<h3>Exercise</h3>
<ul>
<li>Use the <code>predict()</code> function to make predictions with <code>model</code> on the full <code>Boston</code> housing dataset. Print the result to the console.</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb54-1"></a><span class="co"># Predict on full Boston dataset</span></span>
<span id="cb54-2"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb54-2"></a><span class="kw">head</span>(<span class="kw">predict</span>(model, <span class="dt">newdata =</span> Boston))</span></code></pre></div>
<pre><code>       1        2        3        4        5        6 
30.00384 25.02556 30.56760 28.60704 27.94352 25.25628 </code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="regression-models-fitting-them-and-evaluating-their-performance.html#cb56-1"></a><span class="kw">tail</span>(<span class="kw">predict</span>(model, <span class="dt">newdata =</span> Boston))</span></code></pre></div>
<pre><code>     501      502      503      504      505      506 
20.46871 23.53334 22.37572 27.62743 26.12797 22.34421 </code></pre>
<hr />

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-caret">
<p>Kuhn, Max. 2020. <em>Caret: Classification and Regression Training</em>. <a href="https://github.com/topepo/caret/">https://github.com/topepo/caret/</a>.</p>
</div>
<div id="ref-R-ggplot2">
<p>Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and Dewey Dunnington. 2020. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="classification-models-fitting-them-and-evaluating-their-performance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MachineLearningToolboxSC.pdf", "MachineLearningToolboxSC.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
